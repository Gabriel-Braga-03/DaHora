unit Controller.Inicial;

interface
    uses Model.FileManager;

    // Variáveis de Controle
    var
        fm: TFileManager;

    // Rotinas de Controle
    procedure criarNovoArquivo(nome: String; aulas: Byte);

implementation
    uses System.SysUtils, Vcl.Dialogs;

    // Implemetações
    procedure criarNovoArquivo(nome: String; aulas: Byte);
    var
        lista : TArrayStrings;
        arq_nome: String;
    begin
        // Criando instância de Gerenciador de Arquivos
        fm := TFileManager.Create('_docs', true);

        // Criando _docs se não existir
        if not fm.existDir() then fm.createDir();

        // Listando arquivos da pasta
        lista := fm.find('*.json');

        // Gerando nome do novo arquivo
        if Length(lista) <> 0 then
        begin showMessage(lista[High(lista)].Length.ToString);
            arq_nome := lista[High(lista)];

            // Incrementando número do nome do arquivo
            arq_nome := 'hor-'+ IntToStr(StrToInt(arq_nome.Substring(4, arq_nome.Length - 9)) + 1) + '.json';
        end;

        // Criando o arquivo
        fm.setArqPath('./_docs/'+ arq_nome);
    end;

end.
